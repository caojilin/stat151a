par(mfrow=c(1,1))
y = c(y1,y2,y3)
plot(y ~ x)
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
par(mfrow=c(1,1))
y = c(y1,y2,y3)
plot(y ~ x)
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
par(mfrow=c(1,1))
y = c(y1,y2,y3)
plot(y ~ x)
M = 10000
M = 10000
knitr::opts_chunk$set(echo = TRUE)
dat = read.table("PearsonHeightData.txt", header = T)
lmod1 = lm(Son ~ Father, data = dat)
lmod2 = lm(Father ~ Son, data = dat)
plot(Son ~ Father, data = dat)
abline(lmod1, col = "blue")
abline(lmod2, col = "red")
load("meap93.rdata")
dim(data)
y = data$math10
x = data$lnchprg
lms = summary(lm(y~x))
plot(y~x)
z = data$expend
lmod = lm(y ~ z)
summary(lmod)
plot(y~z)
abline(lmod,col="red")
logz=log(data$expend)
lmod = lm(y ~ logz)
summary(lmod)
plot(y~logz)
abline(lmod,col="red")
library(datasets)
a <- anscombe
par(mfrow=c(2,2))
plot(a$x1,a$y1, main=paste("Dataset One"))
plot(a$x2,a$y2, main=paste("Dataset Two"))
plot(a$x3,a$y3, main=paste("Dataset Three"))
plot(a$x4,a$y4, main=paste("Dataset Four"))
lm1 = lm(a$y1 ~ a$x1)
lm2 = lm(a$y2 ~ a$x2)
lm3 = lm(a$y3 ~ a$x3)
lm4 = lm(a$y4 ~ a$x4)
abline(lm1,col="red")
abline(lm2,col="red")
abline(lm3,col="red")
abline(lm4,col="red")
lm1$coefficients[1] + 10 * lm1$coefficients[2]
lm2$coefficients[1] + 10 * lm2$coefficients[2]
lm3$coefficients[1] + 10 * lm3$coefficients[2]
lm4$coefficients[1] + 10 * lm4$coefficients[2]
library(datasets)
a <- anscombe
par(mfrow=c(2,2))
plot(a$x1,a$y1, main=paste("Dataset One"))
plot(a$x2,a$y2, main=paste("Dataset Two"))
plot(a$x3,a$y3, main=paste("Dataset Three"))
plot(a$x4,a$y4, main=paste("Dataset Four"))
lm1 = lm(a$y1 ~ a$x1)
abline(lm1,col="red")
lm2 = lm(a$y2 ~ a$x2)
abline(lm2,col="red")
lm3 = lm(a$y3 ~ a$x3)
abline(lm3,col="red")
lm4 = lm(a$y4 ~ a$x4)
abline(lm4,col="red")
lm1$coefficients[1] + 10 * lm1$coefficients[2]
lm2$coefficients[1] + 10 * lm2$coefficients[2]
lm3$coefficients[1] + 10 * lm3$coefficients[2]
lm4$coefficients[1] + 10 * lm4$coefficients[2]
library(datasets)
a <- anscombe
par(mfrow=c(2,2))
plot(a$x1,a$y1, main=paste("Dataset One"))
plot(a$x2,a$y2, main=paste("Dataset Two"))
library(datasets)
a <- anscombe
par(mfrow=c(2,2))
plot(a$x1,a$y1, main=paste("Dataset One"))
plot(a$x2,a$y2, main=paste("Dataset Two"))
plot(a$x3,a$y3, main=paste("Dataset Three"))
plot(a$x4,a$y4, main=paste("Dataset Four"))
lm1 = lm(a$y1 ~ a$x1)
abline(lm1,col="red")
lm2 = lm(a$y2 ~ a$x2)
abline(lm2,col="red")
lm3 = lm(a$y3 ~ a$x3)
abline(lm3,col="red")
lm4 = lm(a$y4 ~ a$x4)
abline(lm4,col="red")
lm1$coefficients[1] + 10 * lm1$coefficients[2]
lm2$coefficients[1] + 10 * lm2$coefficients[2]
lm3$coefficients[1] + 10 * lm3$coefficients[2]
lm4$coefficients[1] + 10 * lm4$coefficients[2]
library(datasets)
a <- anscombe
par(mfrow=c(2,2))
plot(a$x1,a$y1, main=paste("Dataset One"))
plot(a$x2,a$y2, main=paste("Dataset Two"))
plot(a$x3,a$y3, main=paste("Dataset Three"))
plot(a$x4,a$y4, main=paste("Dataset Four"))
lm1 = lm(a$y1 ~ a$x1)
abline(lm1,col="red")
lm2 = lm(a$y2 ~ a$x2)
abline(lm2,col="red")
lm3 = lm(a$y3 ~ a$x3)
abline(lm3,col="red")
lm4 = lm(a$y4 ~ a$x4)
abline(lm4,col="red")
# lm1$coefficients[1] + 10 * lm1$coefficients[2]
# lm2$coefficients[1] + 10 * lm2$coefficients[2]
# lm3$coefficients[1] + 10 * lm3$coefficients[2]
# lm4$coefficients[1] + 10 * lm4$coefficients[2]
lm1 = lm(a$y1 ~ a$x1)
library(datasets)
a <- anscombe
par(mfrow=c(2,2))
lm1 = lm(a$y1 ~ a$x1)
lm2 = lm(a$y2 ~ a$x2)
lm3 = lm(a$y3 ~ a$x3)
lm4 = lm(a$y4 ~ a$x4)
plot(a$x1,a$y1, main=paste("Dataset One"))
abline(lm1,col="red")
plot(a$x2,a$y2, main=paste("Dataset Two"))
abline(lm2,col="red")
plot(a$x3,a$y3, main=paste("Dataset Three"))
abline(lm3,col="red")
plot(a$x4,a$y4, main=paste("Dataset Four"))
abline(lm4,col="red")
# lm1$coefficients[1] + 10 * lm1$coefficients[2]
# lm2$coefficients[1] + 10 * lm2$coefficients[2]
# lm3$coefficients[1] + 10 * lm3$coefficients[2]
# lm4$coefficients[1] + 10 * lm4$coefficients[2]
lm1$coefficients[1] + 10 * lm1$coefficients[2]
lm2$coefficients[1] + 10 * lm2$coefficients[2]
lm3$coefficients[1] + 10 * lm3$coefficients[2]
lm4$coefficients[1] + 10 * lm4$coefficients[2]
M = 1:10000
M
M = 1:10000
M1=M[M<=65]
y1 = rnorm(length(M1),mean = 32+0.5*M1,sd = 25)
M2=M[M>65 & M<=70]
y2 = 32+0.5*M2+10*rt(n = length(M2),df = 3)
M3=M[M>70]
y3=32+0.5*M3+runif(length(M3),min = -8,max = 8)
y = c(y1,y2,y3)
plot(y ~ M)
y
x
M
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
plot(y ~ x)
M = 1:10000
M1=M[M<=65]
Y1 = rnorm(length(M1),mean = 32+0.5*M1,sd = 25)
M2=M[M>65 & M<=70]
Y2 = 32+0.5*M2+10*rt(n = length(M2),df = 3)
M3=M[M>70]
Y3=32+0.5*M3+runif(length(M3),min = -8,max = 8)
Y = c(Y1,Y2,Y3)
plot(Y ~ M)
lmod = lm(y~M)
lmod = lm(Y~M)
lmod$coefficients
lmod$coefficients[1]
#beta 0
sum(lmod$coefficients[1] -32)/10000
#beta 1
sum(lmod$coefficients[0] -0.5)/10000
# of course, it's very close to zero
sum(lmod$coefficients[0] -0.5)/10000
sum(lmod$coefficients[0] -0.5)
sum(lmod$coefficients[0] -0.5)
0.5000052
0.5000052-0.5
samp = function(n){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
}
samp = function(n){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
return(x,y)
}
samp = function(){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
return(x,y)
}
samp()
samp = function(){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
return(list(x,y))
}
sampl
samp()
a = samp()
a
a[1]
a[[1]]
a =c()
for (i in 1:5) {
}
for (i in 1:5) {
a = c(a,i)
}
a
lmod$coefficients
lmod$coefficients[1]
lmod$coefficients[2]
samp = function(){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
return(list(x,y))
}
beta0_hat = c()
beta1_hat = c()
for (i in M) {
for (i in M) {
sample = samp()
x = sample[[1]]
y = sample[[2]]
lmod = lm(y ~ x)
beta0_hat = c(beta0_hat, lmod$coefficients[1]
beta1_hat = c(beta1_hat, lmod$coefficients[2]
beta0_hat = c()
beta1_hat = c()
for (i in M) {
x = sample[[1]]
y = sample[[2]]
lmod = lm(y ~ x)
beta0_hat = c(beta0_hat, lmod$coefficients[1]
}
for (i in M) {
sample = samp()
x = sample[[1]]
y = sample[[2]]
lmod = lm(y ~ x)
beta0_hat = c(beta0_hat, lmod$coefficients[1]
beta1_hat = c(beta1_hat, lmod$coefficients[2]
sample = samp()
x = sample[[1]]
y = sample[[2]]
x
y
lmod = lm(y ~ x)
lmod
for (i in M) {
sample = samp()
x = sample[[1]]
y = sample[[2]]
lmod = lm(y ~ x)
beta0_hat = c(beta0_hat, lmod$coefficients[1])
beta1_hat = c(beta1_hat, lmod$coefficients[2])
}
beta0_hat
beta1_hat
#beta 0
sum(beta0_hat -32)/10000
#beta 1
sum(beta1_hat -0.5)/10000
#beta 0
sum(beta0_hat -32)/10000
M = 1:10000
samp = function(){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
return(list(x,y))
}
beta0_hat = c()
beta1_hat = c()
for (i in M) {
sample = samp()
x = sample[[1]]
y = sample[[2]]
lmod = lm(y ~ x)
beta0_hat = c(beta0_hat, lmod$coefficients[1])
beta1_hat = c(beta1_hat, lmod$coefficients[2])
}
#beta 0
sum(beta0_hat -32)/10000
# of course, it's very close to zero
#beta 1
sum(beta1_hat -0.5)/10000
# of course, it's very close to zero
lmod = lm(y ~ x)
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
plot(y ~ x)
lmod = lm(y ~ x)
lmod$coefficients
sd(beta0_hat)
sd(beta0_hat)
sd(beta0_hat)
sd(beta0_hat)
sd(beta1_hat)
sd(beta0_hat)
sd(beta1_hat)
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd0)
hist(sd0,sd1)
mpg
mpg$year
hist(mpg$year)
hist(mpg$model)
hist(mpg$cyl)
mpg$cyl
summary(lmod)
summary(lmod)
lmod$coefficients
s = summary(lmod)
s$coefficients
s$coefficients[1]
s$coefficients[2]
s$coefficients[3]
s$coefficients[4]
M = 1:10000
samp = function(){
x = seq(59, 76, length.out = 100)
x1=x[x<=65]
y1 = rnorm(length(x1),mean = 32+0.5*x1,sd = 25)
x2=x[x>65 & x<=70]
y2 = 32+0.5*x2+10*rt(n = length(x2),df = 3)
x3=x[x>70]
y3=32+0.5*x3+runif(length(x3),min = -8,max = 8)
y = c(y1,y2,y3)
return(list(x,y))
}
beta0_hat = c()
beta1_hat = c()
sd_beta0 = c()
sd_beta1 = c()
for (i in M) {
sample = samp()
x = sample[[1]]
y = sample[[2]]
lmod = lm(y ~ x)
beta0_hat = c(beta0_hat, lmod$coefficients[1])
beta1_hat = c(beta1_hat, lmod$coefficients[2])
sd_beta0 = c(sd_beta0,summary(lmod)$coefficients[3])
sd_beta1 = c(sd_beta1,summary(lmod)$coefficients[4])
}
#beta 0
sum(beta0_hat -32)/10000
#beta 1
sum(beta1_hat -0.5)/10000
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
sd0
sd1
sd_beta0
sd_beta1
sd_beta0
hist(sd_beta0)
hist(sd_beta1)
length(sd_beta0)
length(sd_beta1)
knitr::opts_chunk$set(echo = TRUE)
hist(beta0_hat)
hist(beta1_hat)
hist(beta0_hat)
hist(beta0_hat)
abline(v=32)
hist(beta0_hat)
abline(v=32)
hist(beta0_hat)
abline(v=32,col="red")
hist(beta1_hat)
abline(v=0.5,col="red")
#bias of beta 0
sum(beta0_hat -32)/10000
#bias of beta 1
sum(beta1_hat -0.5)/10000
hist(sd_beta1)
hist(sd_beta0)
hist(mp)
mpg
mpgs
mph
mpgs
mtcars
hist(mtcars$carb)
hist(mtcars$cyl)
hist(mtcars$cyl,breaks = 10)
hist(mtcars$cyl,breaks = 5)
hist(mtcars$cyl,breaks = 2)
hist(mtcars$cyl,breaks = 20)
hist(mtcars$cyl,breaks = 200)
hist(mtcars$cyl,breaks = 20)
hist(sd_beta0,breaks = 10)
hist(sd_beta0,breaks = 10)
hist(sd_beta0,breaks = 2)
max(beta0_hat)
hist(sd_beta0,breaks = 200)
min(beta1_hat)
hist(sd_beta0,breaks = 2000)
hist(sd_beta0,breaks = 100)
hist(sd_beta1)
min(beta0_hat)
max(beta0_hat)
max(beta1_hat)
min(beta1_hat)
hist(sd_beta1,breaks=10)
hist(sd_beta1,breaks=100)
lmod
summary(lmod)$coefficients
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd_beta0,breaks = 100)
abline(v=sd0,col="red")
hist(sd_beta1,breaks=100)
abline(v=sd1,col="red")
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd_beta0,breaks = 200)
abline(v=sd0,col="red")
hist(sd_beta1,breaks=200)
abline(v=sd1,col="red")
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd_beta0,breaks = 200)
abline(v=sd0,col="red")
hist(sd_beta1,breaks=50)
abline(v=sd1,col="red")
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd_beta0,breaks = 200)
abline(v=sd0,col="red")
hist(sd_beta1,breaks=90)
abline(v=sd1,col="red")
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd_beta0,breaks = 200)
abline(v=sd0,col="red")
hist(sd_beta1,breaks=100)
abline(v=sd1,col="red")
sd0 = sd(beta0_hat)
sd1 = sd(beta1_hat)
hist(sd_beta0,breaks = 100)
abline(v=sd0,col="red")
hist(sd_beta1,breaks=100)
abline(v=sd1,col="red")
