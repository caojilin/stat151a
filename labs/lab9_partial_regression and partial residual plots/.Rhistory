ï¼ŸavPlot
avPlot
avPlot
avPlot
knitr::opts_chunk$set(
cache=TRUE, warning=FALSE, error=FALSE, message=FALSE, echo=TRUE,
results = 'markup', dev='png', dpi=150
)
library(car)
data(Duncan)
head(Duncan)
mod <- lm(prestige ~ income + education, data=Duncan)
X <- cbind(1, Duncan[,c("income", "education")])
X <- unname(as.matrix(X))
# compute the hat values
H <- X %*% solve(t(X) %*% X) %*% t(X)
lev <- diag(H)
n = length(lev); p = 2
# get the values with high leverage
lev.sorted <- sort(lev, decreasing=T, index.return=T)
plot(1:n, lev)
for(i in lev.sorted$ix[1:3]) {
text(i, lev[i]-0.02, rownames(Duncan)[i])
}
hbar <- (p+1)/n
abline(h=2*hbar, lty=2)
abline(h=3*hbar, lty=2)
cooks<- cooks.distance(model = mod)
plot(cooks)
cooks.sorted <- sort(cooks, decreasing=T, index.return=T)
for(i in cooks.sorted$ix[1:2]) {
text(i, cooks[i]-0.02, rownames(Duncan)[i])
}
qf(0.5, p, n-p)
par(mfrow = c(1,2))
plot(Duncan$income, Duncan$prestige)
plot(Duncan$education, Duncan$prestige)
avPlot(mod, "income")
avPlot(mod, "education")
par(mfrow = c(1,2))
crPlot(mod, variable = "income")
crPlot(mod, variable = "education")
mod2<- lm(prestige ~ income + I(education^2), data = Duncan)
crPlot(mod2, variable = "income")
crPlot(mod2, variable = "I(education^2)")
avPlot(mod, "income")
a = lm(Duncan$prestige ~ Duncan$education)
b = lm(Duncan$income ~ Duncan$education)
plot(a$residuals ~ b$residuals)
avPlot(mod, "income")
plot(a$residuals ~ b$residuals)
knitr::opts_chunk$set(echo = TRUE)
library("model4you")
library(ggplot2)
load("twoyear.rdata")
twoyear = data[c("lwage","jc","univ","exper")]
library(faraway)
body = read.csv("Bodyfat.csv")
body = body[c(2,3,4,5,10)]
lmod1 = lm(lwage ~ jc + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
lmod1 = lm(lwage ~ univ + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
lmod1 = lm(lwage ~ jc + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
lmod1 = lm(lwage ~ univ + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
lmod1 = lm(lwage ~ univ + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
lmod1 = lm(lwage ~ jc + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
lmod1 = lm(lwage ~ univ + I(jc+univ) + exper, data=twoyear)
summary(lmod1)
